<!DOCTYPE html>
<html lang="ja" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <script type="text/javascript" src="rakutensim_api.js"></script>
    <script type="text/javascript">

      function onClicInput() {
        const userId = document.postForm.userId.value;
        const usable = document.postForm.usable.checked ? "true" : "false";
        const comment = document.postForm.comment.value;

        postReport(userId, usable, comment);
      }

      function onClickShowResult() {
        const template = document.getElementById("template");

        analyzeReports().then((result) => {

          const yesList = result["yes"];
          const yesTable = document.getElementById("yes_table");
          yesList.forEach((item) => {
            const clone = document.importNode(template.content, true);
            const td = clone.querySelectorAll("td");
            td[0].textContent = item["user_id"];
            td[1].textContent = item["date"];
            td[2].textContent = item["comment"];
            yesTable.appendChild(clone);
          });

          const noList = result["no"];
          const noTable = document.getElementById("no_table");
          noList.forEach((item) => {
            const clone = document.importNode(template.content, true);
            const td = clone.querySelectorAll("td");
            td[0].textContent = item["user_id"];
            td[1].textContent = item["date"];
            td[2].textContent = item["comment"];
            noTable.appendChild(clone);
          });
        });
      }

    </script>
  </head>
  <body>
    <form style="background-color: gray" class="" name="postForm" action="index.html" method="post">
      <label>user_id:</label>
      <input type="text" name="userId" value="test_user_id">
      <br>
      <label>yes/no:</label>
      <input type="checkbox" name="usable" checked>
      <br>
      <label>commnet:</label>
      <input type="text" name="comment" value="this is a test comment.">

      <br>

      <input type="button" name="button" value="post report"
      onclick="onClicInput()"/>
    </form>

    <br><br>

    <input type="button" name="button" value="show reports"
    onclick="onClickShowResult()"/>

    <div class="">
      <div class="" style="float: left">
        <label>yes repots</label>
        <table id="yes_table" border="1">
          <thead>
            <tr>
              <td>user_id</td>
              <td>date</td>
              <td>comment</td>
            </tr>
          </thead>
        </table>
      </div>

      <div class="" style="float left">
        <label>no repots</label>
        <table id="no_table" border="1">
          <thead>
            <tr>
              <td>user_id</td>
              <td>date</td>
              <td>comment</td>
            </tr>
          </thead>
        </table>
      </div>
    </div>

    <template id="template" style="float left">
      <tr>
        <td></td>
        <td></td>
        <td></td>
      </tr>
    </template>
  </body>
</html>
